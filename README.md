
## Взаимодействие и расширяемость ядра программы

Программа поддерживает любые алгоритмы внедрения и извлечения цифровых водяных знаков в изображения благодаря модульной архитектуре.

## Структура проекта

- watermark/                — основной python-пакет с алгоритмами и фасадом
- tests/                    — unit-тесты, интеграционные и функциональные тесты
  - lsb_tests/                — unit-тесты для LSB
  - integration_tests/lsb/    — интеграционные тесты, визуальные примеры
  - test_data/                — реальные изображения и строки для тестов
- examples/                 — примеры использования (если есть)
- main.py                   — стартовый скрипт-пример

## Запуск юнит-тестов

Запустить все тесты проекта:

python -m unittest discover -s tests


Только для LSB:
python -m unittest tests.lsb_tests.test_lsb_text
python -m unittest tests.lsb_tests.test_lsb_image


## Интеграционные/визуальные тесты

В папке `tests/integration_tests/lsb/` находятся скрипты, которые:
- используют реальные изображения из `tests/test_data/`
- сохраняют результаты и показывают сравнения

Запускать как обычный python-скрипт:
python tests/integration_tests/lsb/lsb_image_demo.py

## Зависимости

- numpy
- pillow
- matplotlib

Установить:
pip install -r requirements.txt

### Базовый интерфейс модулей алгоритмов

Каждый алгоритм реализуется отдельным модулем в папке `watermark/algorithms/` и содержит две обязательные функции:

- **embed(image: np.ndarray, secret: Any, params: dict) -> np.ndarray**
Внедрение водяного знака (секрета) в изображение.
    - `image` — исходное изображение (numpy array)
    - `secret` — водяной знак (строка, данные, изображение, и т.д.)
    - `params` — словарь параметров
    - Возвращает изображение с внедрённым секретом
- **extract(image: np.ndarray, params: dict) -> Any**
Извлечение водяного знака из изображения.
    - `image` — изображение с водяным знаком
    - `params` — словарь параметров
    - Возвращает извлечённый секрет


#### Пример шаблона:

```python
def embed(image: np.ndarray, secret, params: dict) -> np.ndarray:
    # Реализация встраивания водяного знака
    ...

def extract(image: np.ndarray, params: dict):
    # Реализация извлечения водяного знака
    ...
```


### Абстрагирующий слой

Для универсального взаимодействия c различными алгоритмами в проекте используются функции-обёртки (`embedding.py`, `extraction.py`). В них через словарь осуществляется обращение к нужному методу:

```python
# Пример словаря алгоритмов
algorithms = {
    "название_метода": module
}

def embed(image, secret, params, method):
    return algorithms[method].embed(image, secret, params)

def extract(image, params, method):
    return algorithms[method].extract(image, params)
```


### Расширение функциональности

Чтобы добавить новый алгоритм:

1. Создайте новый модуль с функциями `embed` и `extract` согласно базовому интерфейсу.
2. Зарегистрируйте модуль в абстрагирующем слое (добавьте в словарь алгоритмов).
3. При необходимости добавьте параметры и описание в интерфейсе пользователя.

**Все параметры алгоритмов конфигурируются через словарь `params`.**